<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <title>Create and add list template to SharePoint site with content types,site columns and list views | PnP Samples </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Create and add list template to SharePoint site with content types,site columns and list views | PnP Samples ">
    <meta name="generator" content="docfx 2.56.7.0">
    <meta name="description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <!-- Social Media -->
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="Create and add list template to SharePoint site with content types,site columns and list views | PnP Samples ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pnp.github.io/script-samples">
    <meta property="og:image" content="https://pnp.github.io/script-samples/assets/social-media-screenshot.png">
    <meta property="og:image:alt" content="Screenshot example of the PnP Script Samples Site">
    <meta property="og:site_name" content="PnP Script Samples">
    <meta property="og:description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/extra.css">
    <link rel="stylesheet" href="../styles/filter.css">
    <link rel="stylesheet" href="../styles/site.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "8j6pedl344");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
             <div class="github-mark">
              <a href="https://github.com/pnp/script-samples">
                <img src="https://pnp.github.io/script-samples/assets/icons/github-light-64px.png" alt="GitHub Icon Image">
              </a>
            </div>
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../assets/logo.svg" alt="">
              </a>    </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/script-samples/blob/main/scripts/spo-add-list-template-with-custom-library/README.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="create-and-add-list-template-to-sharepoint-site-with-content-typessite-columns-and-list-views">Create and add list template to SharePoint site with content types,site columns and list views</h1>

<h2 id="summary">Summary</h2>
<p><a href="https://docs.microsoft.com/en-us/sharepoint/lists-custom-template">Creating custom list templates</a> is now possible to create both custom document libraries and lists although official microsoft documentation has not specified anything about supporting custom document library templates. This script will create list template with associated site columns, site content types and views for a document library and also creates an instance of a document library.</p>
<p>More about list template
<a href="https://docs.microsoft.com/en-us/sharepoint/lists-custom-template">https://docs.microsoft.com/en-us/sharepoint/lists-custom-template</a></p>
<p><img src="assets/example.png" alt="Example Screenshot"></p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_spoms-ps" role="tab" aria-controls="tabpanel_CeZOj-G++Q_spoms-ps" data-tab="spoms-ps" tabindex="0" aria-selected="true">SPO Management Shell</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_spoms-ps" role="tabpanel" data-tab="spoms-ps"><button class="article-clipboard" title="Copy to clipboard" data-toggle="tooltip" data-placement="top" data-clipboard-target="section[id^='tabpanel'][data-tab='spoms-ps'] pre">
    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span>
    <span class="article-clipboard__message done">Copied</span>
</button>

<pre><code class="lang-powershell">Import-Module Microsoft.Online.SharePoint.PowerShell
###### Declare and Initialize Variables ######  
#SharePoint Admin site
$adminSiteUrl = &quot;https://&lt;tenant&gt;-admin.sharepoint.com&quot;

#Destination site collection url
$url=&quot;https://&lt;tenant&gt;.sharepoint.com/sites/sitename&quot;

# log file will be saved in same directory script was started from  
$currentTime= $(get-date).ToString(&quot;yyyyMMddHHmmss&quot;)  
$logFilePath=&quot;.\log-&quot;+$currentTime+&quot;.log&quot;  


## Start the Transcript  
Start-Transcript -Path $logFilePath 

## Connect to SharePoint Online site  
Connect-PnPOnline -Url $Url -Interactive

##connect-sposervice is needed to do cmdlets involving SPO
Connect-SPOService $adminSiteUrl 

#list template script
# - Create site columns 
# - Create site content type with created site columns

# the cmdlet Get-SPOSiteScriptFromList can be used to get schema of an existing list or library in json
# e.g $extracted = Get-SPOSiteScriptFromList  -ListUrl $listUrl

$list_script = '{
  &quot;$schema&quot;: &quot;https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json&quot;,
  &quot;actions&quot;: [
    {
      &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
      &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{fc2e188e-ba91-48c9-9dd3-16431afddd50}\&quot; Name=\&quot;WorkAddress\&quot; SourceID=\&quot;http://schemas.microsoft.com/sharepoint/v3\&quot; StaticName=\&quot;WorkAddress\&quot; Group=\&quot;Core Contact and Calendar Columns\&quot; DisplayName=\&quot;Address\&quot; Type=\&quot;Note\&quot; NumLines=\&quot;2\&quot; Sortable=\&quot;FALSE\&quot; Customization=\&quot;\&quot; Sealed=\&quot;FALSE\&quot; /&gt;&quot;,
      &quot;pushChanges&quot;: true
    },
    {
      &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
      &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{1dab9b48-2d1a-47b3-878c-8e84f0d211ba}\&quot; Name=\&quot;_Status\&quot; Group=\&quot;Core Document Columns\&quot; Type=\&quot;Choice\&quot; DisplayName=\&quot;Status\&quot; SourceID=\&quot;http://schemas.microsoft.com/sharepoint/v3/fields\&quot; StaticName=\&quot;_Status\&quot; FillInChoice=\&quot;TRUE\&quot; Required=\&quot;TRUE\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; Sealed=\&quot;FALSE\&quot;&gt;&lt;CHOICES&gt;&lt;CHOICE&gt;Not Started&lt;/CHOICE&gt;&lt;CHOICE&gt;Draft&lt;/CHOICE&gt;&lt;CHOICE&gt;Reviewed&lt;/CHOICE&gt;&lt;CHOICE&gt;Scheduled&lt;/CHOICE&gt;&lt;CHOICE&gt;Published&lt;/CHOICE&gt;&lt;CHOICE&gt;Final&lt;/CHOICE&gt;&lt;CHOICE&gt;Expired&lt;/CHOICE&gt;&lt;/CHOICES&gt;&lt;Default&gt;Not Started&lt;/Default&gt;&lt;/Field&gt;&quot;,
      &quot;pushChanges&quot;: true
    },
    {
      &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
      &quot;schemaXml&quot;: &quot;&lt;Field Type=\&quot;Number\&quot; DisplayName=\&quot;digits\&quot; Required=\&quot;TRUE\&quot; EnforceUniqueValues=\&quot;FALSE\&quot; Indexed=\&quot;FALSE\&quot; Group=\&quot;Custom Columns\&quot; ID=\&quot;{7075d07b-be6f-40b8-a6d3-3f340f2fc8e4}\&quot; StaticName=\&quot;digits\&quot; Name=\&quot;digits\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; /&gt;&quot;,
      &quot;pushChanges&quot;: true
    },
    {
      &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
      &quot;schemaXml&quot;: &quot;&lt;Field Name=\&quot;remarks\&quot; FromBaseType=\&quot;FALSE\&quot; Type=\&quot;Note\&quot; DisplayName=\&quot;remarks\&quot; Required=\&quot;TRUE\&quot; EnforceUniqueValues=\&quot;FALSE\&quot; Indexed=\&quot;FALSE\&quot; NumLines=\&quot;6\&quot; RichText=\&quot;TRUE\&quot; RichTextMode=\&quot;Compatible\&quot; IsolateStyles=\&quot;FALSE\&quot; Sortable=\&quot;FALSE\&quot; Group=\&quot;Custom Columns\&quot; ID=\&quot;{b975f483-0490-42cf-b417-db61f26c5e5d}\&quot; StaticName=\&quot;remarks\&quot; CustomFormatter=\&quot;\&quot; RestrictedMode=\&quot;TRUE\&quot; AppendOnly=\&quot;FALSE\&quot; UnlimitedLengthInDocumentLibrary=\&quot;FALSE\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; /&gt;&quot;,
      &quot;pushChanges&quot;: true
    },
    {
      &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
      &quot;schemaXml&quot;: &quot;&lt;Field Type=\&quot;Number\&quot; DisplayName=\&quot;workinghours\&quot; Required=\&quot;TRUE\&quot; EnforceUniqueValues=\&quot;FALSE\&quot; Indexed=\&quot;FALSE\&quot; Group=\&quot;Custom Columns\&quot; ID=\&quot;{ac62eb85-458b-419a-848c-202817fc10c7}\&quot; StaticName=\&quot;workinghours\&quot; Name=\&quot;workinghours\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; /&gt;&quot;,
      &quot;pushChanges&quot;: true
    },
    {
      &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
      &quot;schemaXml&quot;: &quot;&lt;Field Type=\&quot;Choice\&quot; DisplayName=\&quot;Progress\&quot; Required=\&quot;TRUE\&quot; EnforceUniqueValues=\&quot;FALSE\&quot; Indexed=\&quot;FALSE\&quot; Format=\&quot;Dropdown\&quot; FillInChoice=\&quot;FALSE\&quot; Group=\&quot;Custom Columns\&quot; ID=\&quot;{de9d568f-f172-48b1-af97-bd5601bde297}\&quot; StaticName=\&quot;Progress\&quot; Name=\&quot;Progress\&quot; CustomFormatter=\&quot;\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot;&gt;&lt;CHOICES&gt;&lt;CHOICE&gt;draft&lt;/CHOICE&gt;&lt;CHOICE&gt;review&lt;/CHOICE&gt;&lt;CHOICE&gt;complete&lt;/CHOICE&gt;&lt;CHOICE&gt;confirmed&lt;/CHOICE&gt;&lt;/CHOICES&gt;&lt;/Field&gt;&quot;,
      &quot;pushChanges&quot;: true
    },
    {
      &quot;verb&quot;: &quot;createContentType&quot;,
      &quot;name&quot;: &quot;Legal&quot;,
      &quot;id&quot;: &quot;0x01010010BDA71827FC714696179F9B00423E33&quot;,
      &quot;description&quot;: &quot;&quot;,
      &quot;parentId&quot;: &quot;0x0101&quot;,
      &quot;hidden&quot;: false,
      &quot;group&quot;: &quot;EDRM&quot;,
      &quot;subactions&quot;: [
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;WorkAddress&quot;
        },
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;_Status&quot;
        }
      ]
    },
    {
      &quot;verb&quot;: &quot;createContentType&quot;,
      &quot;name&quot;: &quot;test_210304&quot;,
      &quot;id&quot;: &quot;0x010100744FB7B7A02E8242BFB1ABC49CB1CD55&quot;,
      &quot;description&quot;: &quot;&quot;,
      &quot;parentId&quot;: &quot;0x0101&quot;,
      &quot;hidden&quot;: false,
      &quot;group&quot;: &quot;Custom Content Types&quot;,
      &quot;subactions&quot;: [
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;digits&quot;
        },
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;remarks&quot;
        },
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;workinghours&quot;
        },
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;Progress&quot;
        },
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;_Status&quot;
        }
      ]
    },
    {
      &quot;verb&quot;: &quot;createContentType&quot;,
      &quot;name&quot;: &quot;test_StatusComm&quot;,
      &quot;id&quot;: &quot;0x0101005B84CA678AB99C42BFE3447386B910C6&quot;,
      &quot;description&quot;: &quot;&quot;,
      &quot;parentId&quot;: &quot;0x0101&quot;,
      &quot;hidden&quot;: false,
      &quot;group&quot;: &quot;Custom Content Types&quot;,
      &quot;subactions&quot;: [
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;_Status&quot;
        }
      ]
    },
    {
      &quot;verb&quot;: &quot;createContentType&quot;,
      &quot;name&quot;: &quot;test_11&quot;,
      &quot;id&quot;: &quot;0x010100C9A9A0DB54AA6047920A4B13E90DC80B&quot;,
      &quot;description&quot;: &quot;&quot;,
      &quot;parentId&quot;: &quot;0x0101&quot;,
      &quot;hidden&quot;: false,
      &quot;group&quot;: &quot;Custom Content Types&quot;,
      &quot;subactions&quot;: [
        {
          &quot;verb&quot;: &quot;addSiteColumn&quot;,
          &quot;internalName&quot;: &quot;_Status&quot;
        }
      ]
    },
    {
      &quot;verb&quot;: &quot;createSPList&quot;,
      &quot;listName&quot;: &quot;Audit1&quot;,
      &quot;templateType&quot;: 101,
      &quot;subactions&quot;: [
        {
          &quot;verb&quot;: &quot;addSPFieldXml&quot;,
          &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{b0b3407e-1c33-40ed-a37c-2430b7a5d081}\&quot; Name=\&quot;ActualWork\&quot; StaticName=\&quot;ActualWork\&quot; SourceID=\&quot;http://schemas.microsoft.com/sharepoint/v3\&quot; DisplayName=\&quot;Actual Work\&quot; Group=\&quot;Core Task and Issue Columns\&quot; Type=\&quot;Number\&quot; Sealed=\&quot;TRUE\&quot; AllowDeletion=\&quot;TRUE\&quot; Required=\&quot;FALSE\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; /&gt;&quot;
        },
        {
          &quot;verb&quot;: &quot;addSPFieldXml&quot;,
          &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{7a282f86-69d9-40ff-ae1c-c746cf21256b}\&quot; Name=\&quot;Initials\&quot; StaticName=\&quot;Initials\&quot; SourceID=\&quot;http://schemas.microsoft.com/sharepoint/v3\&quot; DisplayName=\&quot;Initials\&quot; Group=\&quot;Core Contact and Calendar Columns\&quot; Type=\&quot;Text\&quot; Sealed=\&quot;TRUE\&quot; AllowDeletion=\&quot;TRUE\&quot; Required=\&quot;FALSE\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; /&gt;&quot;
        },
        {
          &quot;verb&quot;: &quot;addSPFieldXml&quot;,
          &quot;schemaXml&quot;: &quot;&lt;Field Name=\&quot;remarks\&quot; FromBaseType=\&quot;FALSE\&quot; Type=\&quot;Note\&quot; DisplayName=\&quot;remarks\&quot; Required=\&quot;TRUE\&quot; EnforceUniqueValues=\&quot;FALSE\&quot; Indexed=\&quot;FALSE\&quot; NumLines=\&quot;6\&quot; RichText=\&quot;FALSE\&quot; RichTextMode=\&quot;Compatible\&quot; IsolateStyles=\&quot;FALSE\&quot; Sortable=\&quot;FALSE\&quot; Group=\&quot;Custom Columns\&quot; ID=\&quot;{b975f483-0490-42cf-b417-db61f26c5e5d}\&quot; StaticName=\&quot;remarks\&quot; CustomFormatter=\&quot;\&quot; RestrictedMode=\&quot;TRUE\&quot; AppendOnly=\&quot;FALSE\&quot; UnlimitedLengthInDocumentLibrary=\&quot;FALSE\&quot; Hidden=\&quot;FALSE\&quot; Customization=\&quot;\&quot; ReadOnly=\&quot;FALSE\&quot; PITarget=\&quot;\&quot; PrimaryPITarget=\&quot;\&quot; PIAttribute=\&quot;\&quot; PrimaryPIAttribute=\&quot;\&quot; Aggregation=\&quot;\&quot; Node=\&quot;\&quot; /&gt;&quot;
        },
        {
          &quot;verb&quot;: &quot;addSPFieldXml&quot;,
          &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{52578fc3-1f01-4f4d-b016-94ccbcf428cf}\&quot; Name=\&quot;_Comments\&quot; SourceID=\&quot;http://schemas.microsoft.com/sharepoint/v3\&quot; StaticName=\&quot;_Comments\&quot; Group=\&quot;Core Document Columns\&quot; Type=\&quot;Note\&quot; DisplayName=\&quot;Comments\&quot; Sortable=\&quot;FALSE\&quot; Description=\&quot;A summary of this resource\&quot; Sealed=\&quot;TRUE\&quot; UnlimitedLengthInDocumentLibrary=\&quot;TRUE\&quot; AllowDeletion=\&quot;TRUE\&quot; ShowInFileDlg=\&quot;FALSE\&quot; DelayActivateTemplateBinding=\&quot;GROUP,SPSPERS,SITEPAGEPUBLISHING\&quot; /&gt;&quot;
        },
        {
          &quot;verb&quot;: &quot;addContentType&quot;,
          &quot;name&quot;: &quot;Document&quot;,
          &quot;id&quot;: &quot;0x0101&quot;
        },
        {
          &quot;verb&quot;: &quot;addContentType&quot;,
          &quot;name&quot;: &quot;Folder&quot;,
          &quot;id&quot;: &quot;0x0120&quot;
        },
        {
          &quot;verb&quot;: &quot;addContentType&quot;,
          &quot;name&quot;: &quot;Legal&quot;,
          &quot;id&quot;: &quot;0x01010010BDA71827FC714696179F9B00423E33&quot;
        },
        {
          &quot;verb&quot;: &quot;addContentType&quot;,
          &quot;name&quot;: &quot;test_210304&quot;,
          &quot;id&quot;: &quot;0x010100744FB7B7A02E8242BFB1ABC49CB1CD55&quot;
        },
        {
          &quot;verb&quot;: &quot;addContentType&quot;,
          &quot;name&quot;: &quot;test_StatusComm&quot;,
          &quot;id&quot;: &quot;0x0101005B84CA678AB99C42BFE3447386B910C6&quot;
        },
        {
          &quot;verb&quot;: &quot;addContentType&quot;,
          &quot;name&quot;: &quot;test_11&quot;,
          &quot;id&quot;: &quot;0x010100C9A9A0DB54AA6047920A4B13E90DC80B&quot;
        },
        {
          &quot;verb&quot;: &quot;addSPView&quot;,
          &quot;name&quot;: &quot;All Documents&quot;,
          &quot;viewFields&quot;: [
            &quot;DocIcon&quot;,
            &quot;LinkFilename&quot;,
            &quot;Modified&quot;,
            &quot;Editor&quot;
          ],
          &quot;query&quot;: &quot;&lt;OrderBy&gt;&lt;FieldRef Name=\&quot;FileLeafRef\&quot; /&gt;&lt;/OrderBy&gt;&quot;,
          &quot;rowLimit&quot;: 30,
          &quot;isPaged&quot;: true,
          &quot;makeDefault&quot;: true,
          &quot;replaceViewFields&quot;: true
        },
        {
          &quot;verb&quot;: &quot;addSPView&quot;,
          &quot;name&quot;: &quot;All Documents sorted&quot;,
          &quot;viewFields&quot;: [
            &quot;DocIcon&quot;,
            &quot;LinkFilename&quot;,
            &quot;Modified&quot;,
            &quot;Editor&quot;,
            &quot;ActualWork&quot;,
            &quot;_Status&quot;,
            &quot;workinghours&quot;,
            &quot;Progress&quot;
          ],
          &quot;query&quot;: &quot;&lt;OrderBy&gt;&lt;FieldRef Name=\&quot;FileLeafRef\&quot; /&gt;&lt;/OrderBy&gt;&quot;,
          &quot;rowLimit&quot;: 30,
          &quot;isPaged&quot;: true,
          &quot;replaceViewFields&quot;: true
        }
      ]
    }
  ]
}'

Add-SPOSiteScript -Title &quot;Test Document Library&quot; -Description &quot;This creates a custom document library&quot; -Content $extracted 
$siteScripts = Get-SPOSiteScript

$siteScriptObj = $siteScripts | Where-Object {$_.Title -eq &quot;Test Document Library&quot;} 

Add-SPOListDesign -Title &quot;Test Document Library&quot; -Description &quot;Deploy document library with content types and views&quot; -SiteScripts $siteScriptObj.Id-ListColor Pink -ListIcon BullseyeTarget

$listDesigns = Get-SPOListDesign
$listDesign = $listDesigns | Where-Object {$_.Title -eq &quot;Test Document Library&quot;} 

 #invoke list template to create an instance of the library
Invoke-SPOListDesign -Identity $listDesign.Id -WebUrl $siteUrl 

## Disconnect the context  
Disconnect-PnPOnline  
 
## Stop Transcript  
Stop-Transcript  

</code></pre>
<p><img src="assets/results.png" alt="Results Screenshot"></p>
<div class="NOTE">
<h5>Note</h5>
<p>SharePoint tenant admin right are required to be able add list design</p>
</div>
<div class="highlight-tool">
<p>Check out the <strong>SPO Management Shell</strong> to learn more at: <a href="https://docs.microsoft.com/en-us/powershell/sharepoint/sharepoint-online/introduction-sharepoint-online-management-shell?view=sharepoint-ps">Introduction SharePoint Online Management Shell | Microsoft Docs</a></p>
</div>
</section>
</div>
<h2 id="source-credit">Source Credit</h2>
<p>Inspired by <a href="https://reshmeeauckloo.wordpress.com/2021/10/27/invoke-spolistdesign-to-create-instances-of-lists-libraires/">Invoke-SPOListDesign to create instances of lists/libraires</a></p>
<h2 id="contributors">Contributors</h2>
<table>
<thead>
<tr>
<th>Author(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reshmee Auckloo</td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THESE SAMPLES ARE PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<img src="https://pnptelemetry.azurewebsites.net/script-samples/scripts/spo-add-list-template-with-custom-library" aria-hidden="true">
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Script Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <!-- <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer"> -->
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    
    <script type="text/javascript" src="../styles/clipboard.min.js"></script>
    <script type="text/javascript" src="../styles/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="../styles/loadsamples.js"></script>
    <script type="text/javascript" src="../styles/filtersamples.js"></script>

  </body>
</html>