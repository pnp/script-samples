<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <title>Create bulk dummy documents in SharePoint Document library | PnP Samples </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Create bulk dummy documents in SharePoint Document library | PnP Samples ">
    <meta name="generator" content="docfx 2.56.7.0">
    <meta name="description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <!-- Social Media -->
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="Create bulk dummy documents in SharePoint Document library | PnP Samples ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pnp.github.io/script-samples">
    <meta property="og:image" content="https://pnp.github.io/script-samples/assets/social-media-screenshot.png">
    <meta property="og:image:alt" content="Screenshot example of the PnP Script Samples Site">
    <meta property="og:site_name" content="PnP Script Samples">
    <meta property="og:description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/extra.css">
    <link rel="stylesheet" href="../styles/filter.css">
    <link rel="stylesheet" href="../styles/site.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "8j6pedl344");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
             <div class="github-mark">
              <a href="https://github.com/pnp/script-samples" title="Go to repository">
               <div class="github-wrapper">
                  <div class="github-icon">
                    <img src="https://pnp.github.io/script-samples/assets/icons/github-light-64px.png" alt="GitHub Icon Image">
                  </div>
                  <div class="github-repository">
                    <span>GitHub</span>
                    <ul class="github-facts">
                      <li>
                        <i class="fa fa-code-fork" aria-hidden="true"></i>
                        <span class="github-forks"></span>
                      </li>
                      <li>
                        <i class="fa fa-star-o" aria-hidden="true"></i>
                        <span class="github-stars"></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </a>
            </div>
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../assets/logo.svg" alt="">
              </a>    </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/script-samples/blob/main/scripts/create-dummy-docs-in-library/README.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="create-bulk-dummy-documents-in-sharepoint-document-library">Create bulk dummy documents in SharePoint Document library</h1>

<h2 id="summary">Summary</h2>
<p>There are times when we have to replicate scenario to bulk upload dummy documents in large numbers for replicating 5000 items limit or testing performance of dec/test/uat enviorments. This script would help us create 'n' number of dummy documents specified as maxCount in script. Script will also provide option to create dummy folder first for each file and then upload file inside that folder. Script will use the specified file and add counter inside file name to provide uniqueness of file.</p>
<p>Note about two available options</p>
<ul>
<li>Upload the dummy files directly on the SP library, you can provide this path in &quot;$Folder&quot;</li>
<li>Create a dummy folder first and upload the file inside that folder, you can provide the root path in &quot;$SiteRelativeURL&quot;</li>
</ul>
<h2 id="implementation">Implementation</h2>
<ul>
<li>Open Windows PowerShell ISE</li>
<li>Create a new file</li>
<li>Write a script as below,</li>
<li>Change the variables to target to your enviorment, site, document library, document path, max count</li>
<li>Run the script.</li>
</ul>
<h2 id="screenshot-of-output">Screenshot of Output</h2>
<p>Below is the output after I have ran the script twice with maxCount set to 5,</p>
<ul>
<li>Input as Folder (it has created five folder with auto incrementing folder name to get uniqueness and then added file inside each folder)</li>
<li>Input as File  (it has created five files and auto incremented file name to get uniqueness)</li>
</ul>
<p><img src="assets/preview.png" alt="Example Screenshot"></p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_pnpps" role="tab" aria-controls="tabpanel_CeZOj-G++Q_pnpps" data-tab="pnpps" tabindex="0" aria-selected="true">PnP PowerShell</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_pnpps" role="tabpanel" data-tab="pnpps"><button class="article-clipboard" title="Copy to clipboard" data-toggle="tooltip" data-placement="top" data-clipboard-target="section[id^='tabpanel'][data-tab='pnpps'] pre">
    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span>
    <span class="article-clipboard__message done">Copied</span>
</button>

<pre><code class="lang-powershell">
#Global Variable Declaration

$pnpPowerShellModule = Get-Module PnP.PowerShell
if ($null -eq $pnpPowerShellModule) {
    Install-Module PnP.PowerShell
}

#Global Variables 
$SiteURL = &quot;https://yourdomain.sharepoint.com/sites/mytestsite&quot; 

#Serverrelative url of the Library, this will be used for Folder scenario
$SiteRelativeURL= &quot;/sites/mytestsite/Shared Documents&quot;

#Local file path where a single dummy document is available

$File= &quot;D:\SP\repos\myscriptsamples\Dummy.docx&quot;

#This can be used for file scenario and provide the folder path where we want to create files, it can be subfolder also
$Folder=&quot;Shared Documents&quot;

#Read Information to get which operation need to perform
$MethodCall=Read-Host &quot;Which Function Do you Need to Invoke ? Folder or File&quot; 
$MethodCall=$MethodCall.ToUpper() 

#This will be max count of dummy folder or files which we have to create
$maxCount = 5


#For Sample Document Creation the file needs to be part of some location.
$FilePath= Get-ChildItem &quot;D:\SP\repos\myscriptsamples\Dummy.docx&quot;
$FileName = $FilePath.BaseName #Inorder to get the filename for the manipulation we used this function(BaseName)

#For Logging the Operations
$LogTime = Get-Date -Format &quot;MM-dd-yyyy_hh-mm-ss&quot;
$LogFile = 'D:\SP\repos\myscriptsamples\'+&quot;FileFolderCreation_&quot;+$LogTime+&quot;.txt&quot;
 

 if($MethodCall -eq &quot;FOLDER&quot; -or $MethodCall -eq &quot;FILE&quot;)
 {

 Try 
{
    #Connect to PnP Online
    Connect-PnPOnline -Url $SiteURL -UseWebLogin
    #To Create Folder and Files  
    if($MethodCall -eq &quot;FOLDER&quot;)
    {
    	$FolderCnt=0
    	while($FolderCnt -lt $maxCount)
    	{
		    $FolderName= $FileName +&quot;_&quot;+ $FolderCnt
			write-host $FolderName
		    $SiteRelativePath=$SiteRelativeURL+&quot;/&quot;+$FolderName
			write-host $SiteRelativePath
		    Try
		    {
			    Add-PnPFolder -Name $FolderName -Folder $SiteRelativeURL -ErrorAction Stop
			write-host $SiteRelativePath

                Add-PnPFile -Folder $SiteRelativePath -Path $File
			   
		    }
		    catch 
		    {
    		    write-host &quot;Folder Creation Error: $($_.Exception.Message)&quot; -foregroundcolor Red
		    }
            $FolderCnt++
    	}
       
        write-output &quot;New Folder and Files Created '$FolderName' Added! $($env:computername)&quot; &gt;&gt; $LogFile 
         Write-host -f Green &quot;Script execution completed....&quot; |Out-File $LogFile -Append -Force 
          write-output &quot;Script execution completed.... $($env:computername)&quot; &gt;&gt; $LogFile -f Green
    }

    #To Create Files alone
    if($MethodCall -eq &quot;FILE&quot;)
    {
	    $FileCnt=0
	    while($FileCnt -lt $maxCount)
	    {
		    $NewFileName= $FileName+&quot;_&quot;+$FileCnt+&quot;.docx&quot;
		    try
		    {
			    Add-PnPFile -Path $File -Folder $Folder -NewFileName $NewFileName
		    }
		    catch
		    {
			    write-host &quot;Error: $($_.Exception.Message)&quot; -foregroundcolor Red
		    }
		    $FileCnt++
		    Write-host -f Green &quot;New File Created '$NewFileName' Added!&quot; |Out-File $LogFile -Append -Force 
            write-output &quot;New File Created '$NewFileName' Added! $($env:computername)&quot; &gt;&gt; $LogFile -f Green
    
	    }
            Write-host -f Green &quot;Script execution completed....&quot; |Out-File $LogFile -Append -Force 
            write-output &quot;Script execution completed.... $($env:computername)&quot; &gt;&gt; $LogFile -f Green
    }
}
catch 
{
    write-host &quot;Error: $($_.Exception.Message)&quot; -foregroundcolor Red
}

 }
 else{
 write-host &quot;Please type either File or Folder&quot; -foregroundcolor Red
 }

</code></pre>
<div class="highlight-tool">
<p>Check out the <strong>PnP PowerShell</strong> to learn more at: <a href="https://aka.ms/pnp/powershell">https://aka.ms/pnp/powershell</a></p>
</div>
</section>
</div>
<h2 id="contributors">Contributors</h2>
<table>
<thead>
<tr>
<th>Author(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Siddharth Vaghasia</td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THESE SAMPLES ARE PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<img src="https://pnptelemetry.azurewebsites.net/script-samples/scripts/create-dummy-docs-in-library" aria-hidden="true">
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Script Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <!-- <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer"> -->
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    
    <script type="text/javascript" src="../styles/clipboard.min.js"></script>
    <script type="text/javascript" src="../styles/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="../styles/loadsamples.js"></script>
    <script type="text/javascript" src="../styles/filtersamples.js"></script>

  </body>
</html>