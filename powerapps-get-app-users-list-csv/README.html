<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <title>Export all PowerApps details and its Role assignments from Tenant in CSV format | PnP Samples </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" "="">
    <meta name="title" content="Export all PowerApps details and its Role assignments from Tenant in CSV format | PnP Samples ">
    <meta name="generator" content="docfx 2.56.7.0">
    <meta name="description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <!-- Social Media -->
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="Export all PowerApps details and its Role assignments from Tenant in CSV format | PnP Samples ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pnp.github.io/script-samples">
    <meta property="og:image" content="https://pnp.github.io/script-samples/assets/social-media-screenshot.png">
    <meta property="og:image:alt" content="Screenshot example of the PnP Script Samples Site">
    <meta property="og:site_name" content="PnP Script Samples">
    <meta name="msvalidate.01" content="04EFEDA66EC42C08A1247C979E2F9ADD">
    <meta property="og:description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/extra.css">
    <link rel="stylesheet" href="../styles/filter.css">
    <link rel="stylesheet" href="../styles/site.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "8j6pedl344");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
             <div class="github-mark">
              <a href="https://github.com/pnp/script-samples" title="Go to repository">
               <div class="github-wrapper">
                  <div class="github-icon">
                    <img src="https://pnp.github.io/script-samples/assets/icons/github-light-64px.png" alt="GitHub Icon Image">
                  </div>
                  <div class="github-repository">
                    <span>GitHub</span>
                    <ul class="github-facts">
                      <li>
                        <i class="fa fa-code-fork" aria-hidden="true"></i>
                        <span class="github-forks"></span>
                      </li>
                      <li>
                        <i class="fa fa-star-o" aria-hidden="true"></i>
                        <span class="github-stars"></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </a>
            </div>
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../assets/logo.svg" alt="">
              </a>    </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/script-samples/blob/main/scripts/powerapps-get-app-users-list-csv/README.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="export-all-powerapps-details-and-its-role-assignments-from-tenant-in-csv-format">Export all PowerApps details and its Role assignments from Tenant in CSV format</h1>

<h2 id="summary">Summary</h2>
<p>This powershell script will export all the powerapps in a particular tenant and all its environment and its role assignments in csv format.</p>
<p>Script will export AppID, AppDisplay Name, User Display name, User Email, Role Type(Owner/CanView/CanEdit), Environment, App Created Time, App Modified Time.
Also some internal properties like description, appUris, createdTime, lastModifiedTime, sharedGroupsCount, sharedUsersCount, appOpenProtocolUri, appOpenUri, appPlayUri, appPlayEmbeddedUri, appPlayTeamsUri, connectionReferences, userAppMetadata, isFeaturedApp, bypassConsent, isHeroApp, environment, almMode, performanceOptimizationEnabled, unauthenticatedWebPackageHint, canConsumeAppPass, enableModernRuntimeMode, executionRestrictions, appPlanClassification, usesPremiumApi, usesOnlyGrandfatheredPremiumApis, usesCustomApi, usesOnPremiseGateway, usesPcfExternalServiceUsage, isCustomizable, chatPaneCopilotEnabled, draftingCopilotEnabled.</p>
<blockquote>
<p>Note: This uses a pre-release version of the PowerApps PowerShell cmdlets. The cmdlets are subject to change.</p>
</blockquote>
<p><img src="assets/SampleOutPut.png" alt="Example Screenshot"></p>
<h2 id="implementation">Implementation</h2>
<ul>
<li>Open Windows PowerShell ISE</li>
<li>Create a new file</li>
<li>Save the file and run it</li>
<li>Make sure you are PowerApps admin to so that you have access to all the apps</li>
</ul>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_powerapps-ps" role="tab" aria-controls="tabpanel_CeZOj-G++Q_powerapps-ps" data-tab="powerapps-ps" tabindex="0" aria-selected="true">Power Apps PowerShell</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_powerapps-ps" role="tabpanel" data-tab="powerapps-ps">

<pre><code class="lang-powershell">

#Modules for PowerApps Powershell Commands
Install-Module -Name Microsoft.PowerApps.Administration.PowerShell
Install-Module -Name Microsoft.PowerApps.PowerShell -AllowClobber

#PowerApps Connection
Add-PowerAppsAccount

$currentTime=$(get-date).ToString(&quot;yyyyMMddHHmmss&quot;);    
$outputFilePath=&quot;D:\SP\repos\PowerAppsInventory-&quot;+$currentTime+&quot;.csv&quot;    
$resultColl=@()   

write-host -ForegroundColor Magenta &quot;Getting all the PowerApp Details...&quot;  
   
# Get all the PowerApps  
$apps=Get-AdminPowerApp 
foreach($app in $apps)  
{  
   
   foreach($user in Get-PowerAppRoleAssignment -Appname $app.Appname)
   { 
    $result = New-Object PSObject
    $result | Add-Member -MemberType NoteProperty -name &quot;AppName&quot; -value $app.AppName -Force
    $result | Add-Member -MemberType NoteProperty -name &quot;DisplayName&quot; -value $app.DisplayName  -Force
    $result | Add-Member -MemberType NoteProperty -name &quot;PrincipalDisplayName&quot; -value $user.PrincipalDisplayName-Force
    $result | Add-Member -MemberType NoteProperty -name &quot;PrincipalEmail&quot; -value $user.PrincipalEmail-Force
    $result | Add-Member -MemberType NoteProperty -name &quot;RoleType&quot; -value $user.RoleType-Force
    $result | Add-Member -MemberType NoteProperty -name &quot;Environment&quot; -value $app.EnvironmentName -Force
    $result | Add-Member -MemberType NoteProperty -Name &quot;CreatedTime&quot; -value $app.CreatedTime  -Force
    $result | Add-Member -MemberType NoteProperty -Name &quot;LastModifiedTime&quot; -value $app.LastModifiedTime  -Force

    # Getting more details about the app
   #  displayName, description, appUris, createdTime, lastModifiedTime, sharedGroupsCount, sharedUsersCount, appOpenProtocolUri, appOpenUri, appPlayUri, appPlayEmbeddedUri, appPlayTeamsUri, connectionReferences, userAppMetadata, isFeaturedApp, bypassConsent, isHeroApp, environment, almMode, performanceOptimizationEnabled, unauthenticatedWebPackageHint, canConsumeAppPass, enableModernRuntimeMode, executionRestrictions, appPlanClassification, usesPremiumApi, usesOnlyGrandfatheredPremiumApis, usesCustomApi, usesOnPremiseGateway, usesPcfExternalServiceUsage, isCustomizable, chatPaneCopilotEnabled, draftingCopilotEnabled

   $propertyNames = @(
    &quot;displayName&quot;,
    &quot;description&quot;,
    &quot;appUris&quot;,
    &quot;createdTime&quot;,
    &quot;lastModifiedTime&quot;,
    &quot;sharedGroupsCount&quot;,
    &quot;sharedUsersCount&quot;,
    &quot;appOpenProtocolUri&quot;,
    &quot;appOpenUri&quot;,
    &quot;appPlayUri&quot;,
    &quot;appPlayEmbeddedUri&quot;,
    &quot;appPlayTeamsUri&quot;,
    &quot;connectionReferences&quot;,
    &quot;userAppMetadata&quot;,
    &quot;isFeaturedApp&quot;,
    &quot;bypassConsent&quot;,
    &quot;isHeroApp&quot;,
    &quot;environment&quot;,
    &quot;almMode&quot;,
    &quot;performanceOptimizationEnabled&quot;,
    &quot;unauthenticatedWebPackageHint&quot;,
    &quot;canConsumeAppPass&quot;,
    &quot;enableModernRuntimeMode&quot;,
    &quot;executionRestrictions&quot;,
    &quot;appPlanClassification&quot;,
    &quot;usesPremiumApi&quot;,
    &quot;usesOnlyGrandfatheredPremiumApis&quot;,
    &quot;usesCustomApi&quot;,
    &quot;usesOnPremiseGateway&quot;,
    &quot;usesPcfExternalServiceUsage&quot;,
    &quot;isCustomizable&quot;,
    &quot;chatPaneCopilotEnabled&quot;,
    &quot;draftingCopilotEnabled&quot;
)

# You can now use $propertyNames as an array of these properties
 foreach($appProp in $app | select -ExpandProperty Internal | select -ExpandProperty Properties)
    {
      foreach($propName in $propertyNames){
         $result | Add-Member -MemberType NoteProperty -name $propName -value $appProp.$propName -Force
      }
    }

    $resultColl += $result 
   }
}  

#Export the result Array to CSV file  
$resultColl | Export-Csv $outputFilePath -NoTypeInformation 

write-host -ForegroundColor Magenta &quot;Successful!!&quot;  

</code></pre>
<div class="highlight-tool">
<p>Check out the <strong>Power Apps PowerShell</strong> to learn more at: <a href="https://learn.microsoft.com/power-platform/admin/powerapps-powershell">https://learn.microsoft.com/power-platform/admin/powerapps-powershell</a></p>
</div>
</section>
</div>
<h2 id="contributors">Contributors</h2>
<table>
<thead>
<tr>
<th>Author(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valeras Narbutas</td>
</tr>
<tr>
<td>Siddharth Vaghasia</td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THESE SAMPLES ARE PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<img src="https://m365-visitor-stats.azurewebsites.net/script-samples/scripts/powerapps-get-app-users-list-csv" aria-hidden="true">
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Script Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <!-- <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer"> -->
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    
    <script type="text/javascript" src="../styles/clipboard.min.js"></script>
    <script type="text/javascript" src="../styles/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="../styles/loadsamples.js"></script>
    <script type="text/javascript" src="../styles/filtersamples.js"></script>

  </body>
</html>