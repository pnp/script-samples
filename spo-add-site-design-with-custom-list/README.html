<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <title>Create and add site design to SharePoint site with site columns, content type. | PnP Samples </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" "="">
    <meta name="title" content="Create and add site design to SharePoint site with site columns, content type. | PnP Samples ">
    <meta name="generator" content="docfx 2.56.7.0">
    <meta name="description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <!-- Social Media -->
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="Create and add site design to SharePoint site with site columns, content type. | PnP Samples ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pnp.github.io/script-samples">
    <meta property="og:image" content="https://pnp.github.io/script-samples/assets/social-media-screenshot.png">
    <meta property="og:image:alt" content="Screenshot example of the PnP Script Samples Site">
    <meta property="og:site_name" content="PnP Script Samples">
    <meta name="msvalidate.01" content="04EFEDA66EC42C08A1247C979E2F9ADD">
    <meta property="og:description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/extra.css">
    <link rel="stylesheet" href="../styles/filter.css">
    <link rel="stylesheet" href="../styles/site.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "8j6pedl344");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
             <div class="github-mark">
              <a href="https://github.com/pnp/script-samples" title="Go to repository">
               <div class="github-wrapper">
                  <div class="github-icon">
                    <img src="https://pnp.github.io/script-samples/assets/icons/github-light-64px.png" alt="GitHub Icon Image">
                  </div>
                  <div class="github-repository">
                    <span>GitHub</span>
                    <ul class="github-facts">
                      <li>
                        <i class="fa fa-code-fork" aria-hidden="true"></i>
                        <span class="github-forks"></span>
                      </li>
                      <li>
                        <i class="fa fa-star-o" aria-hidden="true"></i>
                        <span class="github-stars"></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </a>
            </div>
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../assets/logo.svg" alt="">
              </a>    </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/script-samples/blob/main/scripts/spo-add-site-design-with-custom-list/README.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="create-and-add-site-design-to-sharepoint-site-with-site-columns-content-type">Create and add site design to SharePoint site with site columns, content type.</h1>

<h2 id="summary">Summary</h2>
<p>This script will create site design with different column types.</p>
<ul>
<li>Sets regional settings</li>
<li>Creates custom content type</li>
<li>Adds new fields to new content type</li>
<li>Creates new list with new content type</li>
<li>Changes list view to custom one</li>
</ul>
<p>More about site design schema
<a href="https://learn.microsoft.com/sharepoint/dev/declarative-customization/site-design-json-schema">https://learn.microsoft.com/sharepoint/dev/declarative-customization/site-design-json-schema</a></p>
<p><img src="assets/example.png" alt="Example Screenshot"></p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_pnpps" role="tab" aria-controls="tabpanel_CeZOj-G++Q_pnpps" data-tab="pnpps" tabindex="0" aria-selected="true">PnP PowerShell</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_cli-m365-ps" role="tab" aria-controls="tabpanel_CeZOj-G++Q_cli-m365-ps" data-tab="cli-m365-ps" tabindex="-1">CLI for Microsoft 365</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_json1" role="tab" aria-controls="tabpanel_CeZOj-G++Q_json1" data-tab="json1" tabindex="-1">JSON Site Script</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_json2" role="tab" aria-controls="tabpanel_CeZOj-G++Q_json2" data-tab="json2" tabindex="-1">JSON Site Script 2</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_pnpps" role="tabpanel" data-tab="pnpps"><button class="article-clipboard" title="Copy to clipboard" data-toggle="tooltip" data-placement="top" data-clipboard-target="section[id^='tabpanel'][data-tab='pnpps'] pre">
    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span>
    <span class="article-clipboard__message done">Copied</span>
</button>

<pre><code class="lang-powershell">
###### Declare and Initialize Variables ######  

#Destination site collection url
$url=&quot;https://&lt;tenant&gt;.sharepoint.com/sites/sitename&quot;

# log file will be saved in same directory script was started from  
$currentTime= $(get-date).ToString(&quot;yyyyMMddHHmmss&quot;)  
$logFilePath=&quot;.\log-&quot;+$currentTime+&quot;.log&quot;  



## Start the Transcript  
Start-Transcript -Path $logFilePath 

## Connect to SharePoint Online site  
Connect-PnPOnline -Url $Url -Interactive


#Site design script
# - Set site regionalsettings (useful for formatting date type field)
# - Apply custom theme
# - Create site columns (text, number, person, choice)
# - Create site content type with created site columns

#site design version, can be static, for me it is easier check versions
$v = &quot;1&quot;

#content type Id
$ctId = &quot;0x010100A45633E36EDA6040B00F4AE79CBF8F32&quot;

$site_script = '{
    &quot;$schema&quot;: &quot;https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json&quot;,
    &quot;actions&quot;: [
         {
          &quot;verb&quot;: &quot;setRegionalSettings&quot;,
          &quot;timeZone&quot;: 4, 
          &quot;locale&quot;: 2057, 
          &quot;sortOrder&quot;: 25, 
          &quot;hourFormat&quot;: &quot;24&quot;
        },
        {
        &quot;verb&quot;: &quot;applyTheme&quot;,
        &quot;themeJson&quot;: {
          &quot;version&quot;: &quot;2&quot;,
          &quot;isInverted&quot;: false,
          &quot;palette&quot;: {
            &quot;themePrimary&quot;:&quot;#0047ba&quot;,
            &quot;themeLighterAlt&quot;:&quot;#f2f6fc&quot;,
            &quot;themeLighter&quot;:&quot;#c3d4eb&quot;,
            &quot;themeLight&quot;:&quot;#7aabde&quot;,
            &quot;themeTertiary&quot;:&quot;#0091a5&quot;,
            &quot;themeSecondary&quot;:&quot;#c3d4eb&quot;,
            &quot;themeDarkAlt&quot;:&quot;#0040a8&quot;,
            &quot;themeDark&quot;:&quot;#00368d&quot;,
            &quot;themeDarker&quot;:&quot;#002868&quot;,
            &quot;neutralLighterAlt&quot;:&quot;#f8f8f8&quot;,
            &quot;neutralLighter&quot;:&quot;#f4f4f4&quot;,
            &quot;neutralLight&quot;:&quot;#eaeaea&quot;,
            &quot;neutralQuaternaryAlt&quot;:&quot;#dadada&quot;,
            &quot;neutralQuaternary&quot;:&quot;#d0d0d0&quot;,
            &quot;neutralTertiaryAlt&quot;:&quot;#c8c8c8&quot;,
            &quot;neutralTertiary&quot;:&quot;#595959&quot;,
            &quot;neutralSecondary&quot;:&quot;#373737&quot;,
            &quot;neutralPrimaryAlt&quot;:&quot;#2f2f2f&quot;,
            &quot;neutralPrimary&quot;:&quot;#000000&quot;,
            &quot;neutralDark&quot;:&quot;#151515&quot;,
            &quot;black&quot;:&quot;#0b0b0b&quot;,
            &quot;white&quot;:&quot;#ffffff&quot;,
            &quot;primaryBackground&quot;:&quot;#ffffff&quot;,
            &quot;primaryText&quot;:&quot;#000000&quot;,
            &quot;bodyBackground&quot;:&quot;#ffffff&quot;,
            &quot;bodyText&quot;:&quot;#000000&quot;,
            &quot;disabledBackground&quot;:&quot;#f4f4f4&quot;,
            &quot;disabledText&quot;:&quot;#c8c8c8&quot;
           }
         }
        },
        {
          &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
          &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{e1605fb4-611a-4eae-b119-77b4b633b436}\&quot; Type=\&quot;MultiChoice\&quot; DisplayName=\&quot;Hobbies\&quot; Required=\&quot;FALSE\&quot; FillInChoice=\&quot;FALSE\&quot; StaticName=\&quot;Hobbies\&quot; Name=\&quot;Hobbies\&quot;&gt;&lt;DefaultFormula&gt;=\&quot;\&quot;&lt;/DefaultFormula&gt;&lt;CHOICES&gt;&lt;CHOICE&gt;PingPong&lt;/CHOICE&gt;&lt;CHOICE&gt;Books&lt;/CHOICE&gt;&lt;CHOICE&gt;Sharing Is Carring&lt;/CHOICE&gt;&lt;CHOICE&gt;This is easter egg&lt;/CHOICE&gt;&lt;CHOICE&gt;Wearing Mask&lt;/CHOICE&gt;&lt;CHOICE&gt;Face Tatoos&lt;/CHOICE&gt;&lt;CHOICE&gt;Flying with no Cape&lt;/CHOICE&gt;&lt;/CHOICES&gt;&lt;/Field&gt;&quot;
        },
        {
          &quot;verb&quot;: &quot;createSiteColumn&quot;,
          &quot;fieldType&quot;: &quot;Text&quot;,
          &quot;internalName&quot;: &quot;SimpleTextField&quot;,
          &quot;displayName&quot;: &quot;SimpleTextField&quot;,
          &quot;isRequired&quot;: false,
          &quot;id&quot;: &quot;60f37466-fd00-47a3-9665-44b48a743e27&quot;
        },
        {
          &quot;verb&quot;: &quot;createSiteColumn&quot;,
          &quot;fieldType&quot;: &quot;User&quot;,
          &quot;internalName&quot;: &quot;siteColumn4User&quot;,
          &quot;displayName&quot;: &quot;Owner&quot;,
          &quot;isRequired&quot;: false,
          &quot;id&quot;: &quot;181c4370-cdae-471b-9499-730046e55b75&quot;
        },
        {
          &quot;verb&quot;: &quot;createSiteColumn&quot;,
          &quot;fieldType&quot;: &quot;Number&quot;,
          &quot;internalName&quot;: &quot;Number&quot;,
          &quot;displayName&quot;: &quot;Number&quot;,
          &quot;isRequired&quot;: false,
          &quot;id&quot;: &quot;151c4370-cdae-471b-9499-730046e55b78&quot;
        },
        {
          &quot;verb&quot;: &quot;createContentType&quot;,
          &quot;name&quot;: &quot;Powershel Samples&quot;,
          &quot;description&quot;: &quot;Create something with fields&quot;,
          &quot;id&quot;:&quot;'+$ctId+'&quot;,
          &quot;hidden&quot;: false,
          &quot;group&quot;: &quot;Power Samples&quot;,
          &quot;subactions&quot;:
            [
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;Hobbies&quot;
              },
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;SimpleTextField&quot;
              },
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;siteColumn4User&quot;
              },
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;Number&quot;
              }
            ]
        }
 ],
    &quot;bindata&quot;: { },
    &quot;version&quot;: &quot;'+$v+'&quot;
}'

#site script to create list and update it with columns by adding content type
 $site_script_CreateAndUpdateSiteList = '
 {
    &quot;$schema&quot;: &quot;https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json&quot;,
    &quot;actions&quot;: [
    {
                  &quot;verb&quot;: &quot;createSPList&quot;,
                  &quot;listName&quot;: &quot;DemoListForPowerShellSamples&quot;,
                  &quot;templateType&quot;: 100,
                  &quot;subactions&quot;: [
                  {
                      &quot;verb&quot;: &quot;addContentType&quot;,
                      &quot;name&quot;: &quot;Powershel Samples&quot;
                    },
                    {
                        &quot;verb&quot;: &quot;addSPView&quot;,
                        &quot;name&quot;: &quot;Custom View&quot;,
                        &quot;viewFields&quot;:
                        [
                          &quot;Hobbies&quot;,
                          &quot;Number&quot;
                        ],
                        &quot;query&quot;: &quot;&lt;OrderBy&gt;&lt;FieldRef Title=\&quot;FileLeafRef\&quot; Ascending=\&quot;TRUE\&quot; /&gt;&lt;/OrderBy&gt;&quot;,
                        &quot;rowLimit&quot;: 100,
                        &quot;isPaged&quot;: true,
                        &quot;makeDefault&quot;: true
                    },
                    {
                        &quot;verb&quot;: &quot;removeContentType&quot;,
                        &quot;name&quot;: &quot;Item&quot;
                    }
                  
                  ]
                  
    }
            
],
     &quot;bindata&quot;: { },
    &quot;version&quot;: &quot;'+$v+'&quot;
}'

 #add Script to SharePoint sharepoint tenant
 $addScript = Add-PnPSiteScript -Title &quot;This is first script&quot;  -Content $site_script  -Description &quot;Sets regional settings and creates site columns and content type.&quot;
 $site_script_CreateAndUpdateSiteList = Add-PnPSiteScript  -Title &quot;This is second script for list&quot;  -Content $site_script_CreateAndUpdateSiteList  -Description &quot;Create and Update list&quot;

 #add site design to site collection with site script
 $siteDesign = Add-PnPSiteDesign  -Title &quot;DevGods site design&quot;  -WebTemplate &quot;64&quot;  -SiteScriptIds  $addScript.Id,  $site_script_CreateAndUpdateSiteList.Id -Description &quot;Site design for the sample&quot;

 #set design on site collection
 Set-PnPSiteDesign -Identity $siteDesign.Id -Title &quot;DevGods site design&quot;  -WebTemplate &quot;64&quot;  -SiteScriptIds  $addScript.Id,  $site_script_CreateAndUpdateSiteList.Id -Description &quot;Site design for the sample&quot;

 #invoke site design
 Invoke-PnPSiteDesign -Identity $siteDesign.Id -WebUrl $url


## Disconnect the context  
Disconnect-PnPOnline  
 
## Stop Transcript  
Stop-Transcript  

</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>SharePoint tenant admin right are required to be able add site design</p>
</div>
<div class="highlight-tool">
<p>Check out the <strong>PnP PowerShell</strong> to learn more at: <a href="https://aka.ms/pnp/powershell">https://aka.ms/pnp/powershell</a></p>
</div>
</section>
<section id="tabpanel_CeZOj-G++Q_cli-m365-ps" role="tabpanel" data-tab="cli-m365-ps" aria-hidden="true" hidden="hidden"><button class="article-clipboard" title="Copy to clipboard" data-toggle="tooltip" data-placement="top" data-clipboard-target="section[id^='tabpanel'][data-tab='cli-m365-ps'] pre">
    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span>
    <span class="article-clipboard__message done">Copied</span>
</button>

<pre><code class="lang-powershell">###### Declare and Initialize Variables ######  

#Destination site collection url
$url=&quot;https://&lt;tenant&gt;.sharepoint.com/sites/siteurl&quot;

Write-host 'setup script example'

Write-host 'ensure logged in'
$m365Status = m365 status
if ($m365Status -match &quot;Logged Out&quot;) {
  m365 login --authType browser
}


## Connect to SharePoint Online site  
$site = m365 spo site get --url $url 
$site = $site | ConvertFrom-Json


#Site design script
# - Set site regionalsettings (useful for formatting date type field)
# - Apply custom theme
# - Create site columns (text, number, person, choice)
# - Create site content type with created site columns


 #add Script to SharePoint sharepoint tenant 
 $addScript = m365 spo sitescript add --title &quot;This is first script CLI 1&quot; --description &quot;some description &quot; --content &quot;@firstscript.json&quot;
 $addScript =  $addScript | ConvertFrom-Json

 $site_script_CreateAndUpdateSiteList = m365 spo sitescript add --title &quot;This is second script for list CLI 2&quot; --description &quot;Create and Update list CLI2&quot; --content &quot;@secondscript.json&quot;
 $site_script_CreateAndUpdateSiteList = $site_script_CreateAndUpdateSiteList | ConvertFrom-Json
 
 #add site design to site collection with site script
 $siteDesign = m365 spo sitedesign add --title &quot;DevGods site design CLI&quot; --webTemplate &quot;TeamSite&quot; --siteScripts &quot;$($addScript.Id),$($site_script_CreateAndUpdateSiteList.Id)&quot;
 $siteDesign =$siteDesign | ConvertFrom-Json
 
 
 #set design on site collection
 m365 spo sitedesign set --id $siteDesign.Id --title &quot;DevGods site design from cli&quot; --version 2
 
 #invoke site design
 m365 spo sitedesign apply --id $siteDesign.Id --webUrl  $url
 
 m365 logout

</code></pre>
<div class="highlight-tool">
<p>Check out the <strong>CLI for Microsoft 365</strong> to learn more at: <a href="https://aka.ms/cli-m365">https://aka.ms/cli-m365</a></p>
</div>

<div class="NOTE">
<h5>Note</h5>
<p>PowerShell cant correctly pass json of design script if it is added directly in the code.
To make this work save json files in same directory you are running script, in the code above files names &quot;firstscript.json&quot; and &quot;secondscript.json&quot;</p>
</div>
</section>
<section id="tabpanel_CeZOj-G++Q_json1" role="tabpanel" data-tab="json1" aria-hidden="true" hidden="hidden"><button class="article-clipboard" title="Copy to clipboard" data-toggle="tooltip" data-placement="top" data-clipboard-target="section[id^='tabpanel'][data-tab='json1'] pre">
    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span>
    <span class="article-clipboard__message done">Copied</span>
</button>

<pre><code>{
    &quot;$schema&quot;: &quot;https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json&quot;,
    &quot;actions&quot;: [
         {
          &quot;verb&quot;: &quot;setRegionalSettings&quot;,
          &quot;timeZone&quot;: 4, 
          &quot;locale&quot;: 2057, 
          &quot;sortOrder&quot;: 25, 
          &quot;hourFormat&quot;: &quot;24&quot;
        },
        {
        &quot;verb&quot;: &quot;applyTheme&quot;,
        &quot;themeJson&quot;: {
          &quot;version&quot;: &quot;2&quot;,
          &quot;isInverted&quot;: false,
          &quot;palette&quot;: {
            &quot;themePrimary&quot;:&quot;#0047ba&quot;,
            &quot;themeLighterAlt&quot;:&quot;#f2f6fc&quot;,
            &quot;themeLighter&quot;:&quot;#c3d4eb&quot;,
            &quot;themeLight&quot;:&quot;#7aabde&quot;,
            &quot;themeTertiary&quot;:&quot;#0091a5&quot;,
            &quot;themeSecondary&quot;:&quot;#c3d4eb&quot;,
            &quot;themeDarkAlt&quot;:&quot;#0040a8&quot;,
            &quot;themeDark&quot;:&quot;#00368d&quot;,
            &quot;themeDarker&quot;:&quot;#002868&quot;,
            &quot;neutralLighterAlt&quot;:&quot;#f8f8f8&quot;,
            &quot;neutralLighter&quot;:&quot;#f4f4f4&quot;,
            &quot;neutralLight&quot;:&quot;#eaeaea&quot;,
            &quot;neutralQuaternaryAlt&quot;:&quot;#dadada&quot;,
            &quot;neutralQuaternary&quot;:&quot;#d0d0d0&quot;,
            &quot;neutralTertiaryAlt&quot;:&quot;#c8c8c8&quot;,
            &quot;neutralTertiary&quot;:&quot;#595959&quot;,
            &quot;neutralSecondary&quot;:&quot;#373737&quot;,
            &quot;neutralPrimaryAlt&quot;:&quot;#2f2f2f&quot;,
            &quot;neutralPrimary&quot;:&quot;#000000&quot;,
            &quot;neutralDark&quot;:&quot;#151515&quot;,
            &quot;black&quot;:&quot;#0b0b0b&quot;,
            &quot;white&quot;:&quot;#ffffff&quot;,
            &quot;primaryBackground&quot;:&quot;#ffffff&quot;,
            &quot;primaryText&quot;:&quot;#000000&quot;,
            &quot;bodyBackground&quot;:&quot;#ffffff&quot;,
            &quot;bodyText&quot;:&quot;#000000&quot;,
            &quot;disabledBackground&quot;:&quot;#f4f4f4&quot;,
            &quot;disabledText&quot;:&quot;#c8c8c8&quot;
           }
         }
        },
        {
          &quot;verb&quot;: &quot;createSiteColumnXml&quot;,
          &quot;schemaXml&quot;: &quot;&lt;Field ID=\&quot;{e1605fb4-611a-4eae-b119-77b4b633b436}\&quot; Type=\&quot;MultiChoice\&quot; DisplayName=\&quot;Hobbies\&quot; Required=\&quot;FALSE\&quot; FillInChoice=\&quot;FALSE\&quot; StaticName=\&quot;Hobbies\&quot; Name=\&quot;Hobbies\&quot;&gt;&lt;DefaultFormula&gt;=\&quot;\&quot;&lt;/DefaultFormula&gt;&lt;CHOICES&gt;&lt;CHOICE&gt;PingPong&lt;/CHOICE&gt;&lt;CHOICE&gt;Books&lt;/CHOICE&gt;&lt;CHOICE&gt;Sharing Is Carring&lt;/CHOICE&gt;&lt;CHOICE&gt;This is easter egg&lt;/CHOICE&gt;&lt;CHOICE&gt;Wearing Mask&lt;/CHOICE&gt;&lt;CHOICE&gt;Face Tatoos&lt;/CHOICE&gt;&lt;CHOICE&gt;Flying with no Cape&lt;/CHOICE&gt;&lt;/CHOICES&gt;&lt;/Field&gt;&quot;
        },
        {
          &quot;verb&quot;: &quot;createSiteColumn&quot;,
          &quot;fieldType&quot;: &quot;Text&quot;,
          &quot;internalName&quot;: &quot;SimpleTextField&quot;,
          &quot;displayName&quot;: &quot;SimpleTextField&quot;,
          &quot;isRequired&quot;: false,
          &quot;id&quot;: &quot;60f37466-fd00-47a3-9665-44b48a743e27&quot;
        },
        {
          &quot;verb&quot;: &quot;createSiteColumn&quot;,
          &quot;fieldType&quot;: &quot;User&quot;,
          &quot;internalName&quot;: &quot;siteColumn4User&quot;,
          &quot;displayName&quot;: &quot;Owner&quot;,
          &quot;isRequired&quot;: false,
          &quot;id&quot;: &quot;181c4370-cdae-471b-9499-730046e55b75&quot;
        },
        {
          &quot;verb&quot;: &quot;createSiteColumn&quot;,
          &quot;fieldType&quot;: &quot;Number&quot;,
          &quot;internalName&quot;: &quot;Number&quot;,
          &quot;displayName&quot;: &quot;Number&quot;,
          &quot;isRequired&quot;: false,
          &quot;id&quot;: &quot;151c4370-cdae-471b-9499-730046e55b78&quot;
        },
        {
          &quot;verb&quot;: &quot;createContentType&quot;,
          &quot;name&quot;: &quot;Powershel Samples&quot;,
          &quot;description&quot;: &quot;Create something with fields&quot;,
          &quot;id&quot;:&quot;'+$ctId+'&quot;,
          &quot;hidden&quot;: false,
          &quot;group&quot;: &quot;Power Samples&quot;,
          &quot;subactions&quot;:
            [
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;Hobbies&quot;
              },
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;SimpleTextField&quot;
              },
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;siteColumn4User&quot;
              },
              {
                &quot;verb&quot;: &quot;addSiteColumn&quot;,
                &quot;internalName&quot;: &quot;Number&quot;
              }
            ]
        }
 ],
    &quot;bindata&quot;: { },
    &quot;version&quot;: &quot;1&quot;
}
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_json2" role="tabpanel" data-tab="json2" aria-hidden="true" hidden="hidden"><button class="article-clipboard" title="Copy to clipboard" data-toggle="tooltip" data-placement="top" data-clipboard-target="section[id^='tabpanel'][data-tab='json2'] pre">
    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span>
    <span class="article-clipboard__message done">Copied</span>
</button>

<pre><code>{
    &quot;$schema&quot;: &quot;https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json&quot;,
    &quot;actions&quot;: [
    {
                  &quot;verb&quot;: &quot;createSPList&quot;,
                  &quot;listName&quot;: &quot;DemoListForPowerShellSamples&quot;,
                  &quot;templateType&quot;: 100,
                  &quot;subactions&quot;: [
                  {
                      &quot;verb&quot;: &quot;addContentType&quot;,
                      &quot;name&quot;: &quot;Powershel Samples&quot;
                    },
                    {
                        &quot;verb&quot;: &quot;addSPView&quot;,
                        &quot;name&quot;: &quot;Custom View&quot;,
                        &quot;viewFields&quot;:
                        [
                          &quot;Hobbies&quot;,
                          &quot;Number&quot;
                        ],
                        &quot;query&quot;: &quot;&lt;OrderBy&gt;&lt;FieldRef Title=\&quot;FileLeafRef\&quot; Ascending=\&quot;TRUE\&quot; /&gt;&lt;/OrderBy&gt;&quot;,
                        &quot;rowLimit&quot;: 100,
                        &quot;isPaged&quot;: true,
                        &quot;makeDefault&quot;: true
                    },
                    {
                        &quot;verb&quot;: &quot;removeContentType&quot;,
                        &quot;name&quot;: &quot;Item&quot;
                    }
                  
                  ]
                  
    }
            
],
     &quot;bindata&quot;: { },
    &quot;version&quot;: &quot;1&quot;
}
</code></pre>
<div class="highlight-tool">
<p>Check out the <strong>PnP PowerShell</strong> to learn more at: <a href="https://aka.ms/pnp/powershell">https://aka.ms/pnp/powershell</a></p>
</div>
</section>
</div>
<h2 id="contributors">Contributors</h2>
<table>
<thead>
<tr>
<th>Author(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valeras Narbutas</td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THESE SAMPLES ARE PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<img src="https://m365-visitor-stats.azurewebsites.net/script-samples/scripts/spo-add-site-design-with-custom-list" aria-hidden="true">
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Script Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <!-- <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer"> -->
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    
    <script type="text/javascript" src="../styles/clipboard.min.js"></script>
    <script type="text/javascript" src="../styles/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="../styles/loadsamples.js"></script>
    <script type="text/javascript" src="../styles/filtersamples.js"></script>

  </body>
</html>