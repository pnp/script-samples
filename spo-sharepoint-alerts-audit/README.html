<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>SharePoint Online - Export SharePoint Alerts | PnP Samples </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="SharePoint Online - Export SharePoint Alerts | PnP Samples ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="A sample gallery of scripts to manage all things Microsoft 365.">

    <!-- Social Media -->
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="SharePoint Online - Export SharePoint Alerts | PnP Samples ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pnp.github.io/script-samples">
    <meta property="og:image" content="https://pnp.github.io/script-samples/assets/social-media-screenshot.png">
    <meta property="og:image:alt" content="Screenshot example of the PnP Script Samples Site">
    <meta property="og:site_name" content="PnP Script Samples">
    <meta name="msvalidate.01" content="04EFEDA66EC42C08A1247C979E2F9ADD">
  <meta property="og:description" content="A sample gallery of scripts to manage all things Microsoft 365.">

    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/extra.css">
    <link rel="stylesheet" href="../styles/filter.css">
    <link rel="stylesheet" href="../styles/site.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
  
  
  <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "8j6pedl344");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
             <div class="github-mark">
              <a href="https://github.com/pnp/script-samples" title="Go to repository">
               <div class="github-wrapper">
                  <div class="github-icon">
                    <img src="https://pnp.github.io/script-samples/assets/icons/github-light-64px.png" alt="GitHub Icon Image">
                  </div>
                  <div class="github-repository">
                    <span>GitHub</span>
                    <ul class="github-facts">
                      <li>
                        <i class="fa fa-code-fork" aria-hidden="true"></i>
                        <span class="github-forks"></span>
                      </li>
                      <li>
                        <i class="fa fa-star-o" aria-hidden="true"></i>
                        <span class="github-stars"></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </a>
            </div>
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../assets/logo.svg" alt="">
              </a>            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/script-samples/blob/main/scripts/spo-sharepoint-alerts-audit/README.md/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="sharepoint-online---export-sharepoint-alerts">SharePoint Online - Export SharePoint Alerts</h1>

<h2 id="summary">Summary</h2>
<p>This PowerShell script scans your SharePoint Online environment and exports a list of all classic SharePoint Alerts configured by users across all site collections.</p>
<p>This is especially useful in preparation for the upcoming retirement of SharePoint Alerts. The script helps administrators audit alert usage, review who is using alerts and where, and prepare to transition to modern alternatives such as SharePoint Rules or Power Automate.</p>
<h3 id="sharepoint-alerts-retirement-timeline">SharePoint Alerts Retirement Timeline</h3>
<p>Microsoft has announced the deprecation and removal of <strong>classic SharePoint Alerts</strong>. Use this script to assess current alert usage and prepare for a smooth transition.</p>
<h4 id="important-dates-to-keep-in-mind">Important Dates to Keep in Mind</h4>
<ul>
<li><strong>July 2025</strong> – Creation of new SharePoint alerts disabled for <strong>new tenants</strong></li>
<li><strong>September 2025</strong> – Creation of new alerts disabled for <strong>existing tenants</strong></li>
<li><strong>October 2025</strong> – Existing alerts will <strong>expire after 30 days</strong> (they can be manually re-enabled)</li>
<li><strong>July 2026</strong> – <strong>SharePoint Alerts removed entirely</strong></li>
</ul>
<p>After these dates, organisations should use modern alternatives like SharePoint Rules or Power Automate.</p>
<h3 id="features">Features</h3>
<ul>
<li>Connects to all site collections in your tenant</li>
<li>Retrieves classic alerts created by users</li>
<li>Outputs a clean, structured CSV file with alert metadata</li>
<li>Logs connection or permission errors to a separate file</li>
</ul>
<h3 id="sample-output">Sample Output</h3>
<p>Below is an example of the exported <code>SharePointAlerts_Report.csv</code> when opened in Excel:</p>
<p><img src="assets/SharePointAlertAuditOutput.png" alt="Sample SharePoint Alerts Output"></p>
<hr>
<div class="tabGroup" id="tabgroup_1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_1_pnpps" role="tab" aria-controls="tabpanel_1_pnpps" data-tab="pnpps" tabindex="0" aria-selected="true">PnP PowerShell</a>
</li>
</ul>
<section id="tabpanel_1_pnpps" role="tabpanel" data-tab="pnpps">

<pre><code class="lang-powershell"># ============================================================
# SharePoint Alerts Export Script
# Preferred Auth: Certificate
# Alternate Auth: Interactive
# ============================================================

# === Configurable Variables ===
$clientId = &quot;&lt;your-client-id&gt;&quot;
$certPath = &quot;&lt;path-to-certificate-folder&gt;&quot;
$certName = &quot;&lt;your-certificate-name&gt;.pfx&quot;
$tenant = &quot;&lt;your-tenant-id&gt;&quot;

$basePath = &quot;&lt;your-output-directory&gt;&quot;  # Example: &quot;C:\Reports&quot;
$outputCsvName = &quot;SharePointAlerts_Report.csv&quot;
$errorLogName = &quot;SharePointAlerts_Errors.csv&quot;

$tenantAdminUrl = &quot;https://&lt;your-tenant&gt;-admin.sharepoint.com&quot;
$outputCsvPath = Join-Path -Path $basePath -ChildPath $outputCsvName
$errorLogPath = Join-Path -Path $basePath -ChildPath $errorLogName

# === Create output folder if it doesn't exist ===
if (-not (Test-Path -Path $basePath)) {
    New-Item -ItemType Directory -Path $basePath -Force | Out-Null
}

# === Arrays to collect results and errors ===
$alertResults = @()
$errorLog = @()

# === Connect to SharePoint Admin Center ===
# Preferred: Certificate-based authentication
Connect-PnPOnline -Url $tenantAdminUrl -ClientId $clientId -Tenant $tenant -CertificatePath &quot;$certPath\$certName&quot;

# Alternate: Interactive authentication
# Connect-PnPOnline -Url $tenantAdminUrl -Interactive

# === Retrieve all site collections ===
$sites = Get-PnPTenantSite

foreach ($site in $sites) {
    Write-Host &quot;`nProcessing site: $($site.Url)&quot; -ForegroundColor Cyan

    # === Connect to each site ===
    # Preferred: Certificate-based authentication
    Connect-PnPOnline -Url $site.Url -ClientId $clientId -Tenant $tenant -CertificatePath &quot;$certPath\$certName&quot;

    # Alternate (manual run): Interactive authentication
    # Connect-PnPOnline -Url $site.Url -Interactive

    try {
        $alerts = Get-PnPAlert -AllUsers -InformationAction SilentlyContinue
        if ($alerts) {
            Write-Host &quot;Found $($alerts.Count) alerts in: $($site.Url)&quot; -ForegroundColor Green
            foreach ($alert in $alerts) {
                $user = Get-PnPUser -Identity $alert.UserId
                $alertResults += [PSCustomObject]@{
                    SiteUrl          = $site.Url
                    AlertFrequency   = $alert.AlertFrequency
                    AlertType        = $alert.AlertType
                    AlertTime        = $alert.AlertTime
                    AlwaysNotify     = $alert.AlwaysNotify
                    DeliveryChannels = $alert.DeliveryChannels
                    EventType        = $alert.EventType
                    Filter           = $alert.Filter
                    ID               = $alert.ID
                    Status           = $alert.Status
                    Title            = $alert.Title
                    UserId           = $alert.UserId
                    UserName         = $user.Title
                    UserEmail        = $user.Email
                    DispFormUrl      = $alert.Properties[&quot;dispformurl&quot;]
                }
            }
        } else {
            Write-Host &quot;No alerts found.&quot; -ForegroundColor Yellow
        }
    }
    catch {
        $errorMessage = &quot;Error retrieving alerts for site: $($site.Url).&quot;
        Write-Host $errorMessage -ForegroundColor Red

        $errorLog += [PSCustomObject]@{
            SiteUrl      = $site.Url
            ErrorMessage = $_.Exception.Message
            ErrorDetails = $_.Exception.StackTrace
        }
    }
}

# === Export results to CSV ===
$alertResults | Export-Csv -Path $outputCsvPath -NoTypeInformation -Encoding UTF8
Write-Host &quot;`nReport exported to: $outputCsvPath&quot; -ForegroundColor Green

# === Export errors if any ===
if ($errorLog.Count -gt 0) {
    $errorLog | Export-Csv -Path $errorLogPath -NoTypeInformation -Encoding UTF8
    Write-Host &quot;Error log exported to: $errorLogPath&quot; -ForegroundColor Yellow
} else {
    Write-Host &quot;No errors encountered.&quot; -ForegroundColor Green
}

# === Disconnect session ===
Disconnect-PnPOnline
</code></pre>
<div class="highlight-tool">
<p>Check out the <strong>PnP PowerShell</strong> to learn more at: <a href="https://aka.ms/pnp/powershell">https://aka.ms/pnp/powershell</a></p>
</div>
<div class="highlight-tool">
<p>The way you login into PnP PowerShell has changed please read <a href="https://github.com/pnp/powershell/discussions/4249">PnP Management Shell EntraID app is deleted : what should I do ?</a></p>
</div>
</section>
</div>
<h2 id="contributors">Contributors</h2>
<table>
<thead>
<tr>
<th>Author</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.linkedin.com/in/tvahk/">Tanel Vahk</a></td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THESE SAMPLES ARE PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<img src="https://m365-visitor-stats.azurewebsites.net/script-samples/scripts/spo-sharepoint-alerts-audit" aria-hidden="true">

</article>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Script Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
      
            <!-- <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer"> -->
          </div>
        </div>
      </footer>    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>

    <script type="text/javascript" src="../styles/clipboard.min.js"></script>
    <script type="text/javascript" src="../styles/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="../styles/loadsamples.js"></script>
    <script type="text/javascript" src="../styles/filtersamples.js"></script>

  </body>
</html>