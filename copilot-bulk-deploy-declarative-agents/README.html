<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <title>Bulk Deployment of Teams Toolkit Declarative Agents | PnP Samples </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="Bulk Deployment of Teams Toolkit Declarative Agents | PnP Samples ">
    <meta name="generator" content="docfx 2.56.7.0">
    <meta name="description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <!-- Social Media -->
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="Bulk Deployment of Teams Toolkit Declarative Agents | PnP Samples ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pnp.github.io/script-samples">
    <meta property="og:image" content="https://pnp.github.io/script-samples/assets/social-media-screenshot.png">
    <meta property="og:image:alt" content="Screenshot example of the PnP Script Samples Site">
    <meta property="og:site_name" content="PnP Script Samples">
    <meta name="msvalidate.01" content="04EFEDA66EC42C08A1247C979E2F9ADD">
    <meta property="og:description" content="A sample gallery of scripts to manage all things Microsoft 365.">
  
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/extra.css">
    <link rel="stylesheet" href="../styles/filter.css">
    <link rel="stylesheet" href="../styles/site.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "8j6pedl344");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
             <div class="github-mark">
              <a href="https://github.com/pnp/script-samples" title="Go to repository">
               <div class="github-wrapper">
                  <div class="github-icon">
                    <img src="https://pnp.github.io/script-samples/assets/icons/github-light-64px.png" alt="GitHub Icon Image">
                  </div>
                  <div class="github-repository">
                    <span>GitHub</span>
                    <ul class="github-facts">
                      <li>
                        <i class="fa fa-code-fork" aria-hidden="true"></i>
                        <span class="github-forks"></span>
                      </li>
                      <li>
                        <i class="fa fa-star-o" aria-hidden="true"></i>
                        <span class="github-stars"></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </a>
            </div>
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../assets/logo.svg" alt="">
              </a>    </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/script-samples/blob/main/scripts/copilot-bulk-deploy-declarative-agents/README.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="bulk-deployment-of-teams-toolkit-declarative-agents">Bulk Deployment of Teams Toolkit Declarative Agents</h1>

<h2 id="summary">Summary</h2>
<p>This sample deploys multiple Copilot Teams Toolkit declarative agents in bulk using Teams Toolkit CLI, you will need to ensure you are logged in and installed the prerequisites. This runs thorugh a set structure (see below) and provisions the agents into Microsoft 365 Copilot - the chat experience. This is not deploying to the organisation store however this can be modified to do so.</p>
<blockquote>
<p>Note: This script is a campanion to this sample: <a href="https://pnp.github.io/script-samples/copilot-teams-toolkit-da-apply-template/README.html">https://pnp.github.io/script-samples/copilot-teams-toolkit-da-apply-template/README.html</a></p>
</blockquote>
<p><img src="assets/example.png" alt="Example Screenshot"></p>
<h2 id="prerequisites">Prerequisites</h2>
<p>This script requires the following:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/teams-toolkit-cli?pivots=version-three">Teams Toolkit CLI</a> installed</li>
</ul>
<p>Install the Teams Toolkit CLI using the following command:</p>
<ul>
<li>npm install -g @microsoft/teamsapp-cli</li>
<li>Run to test: teamsapp -h</li>
</ul>
<h2 id="folder-structure">Folder Structure</h2>
<ul>
<li>Base Folder
<ul>
<li>Copilot-Extensibility-Template
<ul>
<li>color.png</li>
<li>manifest.json</li>
<li>declarativeAgent.json</li>
<li>Instruction.md</li>
<li>outline.png</li>
</ul>
</li>
<li>Copilot-Studio-Agent (Just create the folder, the script will populate the contents + the template)
<ul>
<li>appPackage
<ul>
<li>manifest.json</li>
<li>declarativeAgent.json</li>
<li>Instruction.md
...</li>
</ul>
</li>
</ul>
</li>
<li>Other Agent 1</li>
<li>Other Agent 2</li>
<li>Other Agent 3</li>
<li>Other Agent 4</li>
</ul>
</li>
<li>Invoke-CoolScript.ps1</li>
</ul>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_ps1" role="tab" aria-controls="tabpanel_CeZOj-G++Q_ps1" data-tab="ps1" tabindex="0" aria-selected="true">PowerShell - Teams App CLI (Single Deployment)</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_ps2" role="tab" aria-controls="tabpanel_CeZOj-G++Q_ps2" data-tab="ps2" tabindex="-1">PowerShell - Teams App CLI (Bulk Deployment)</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_ps1" role="tabpanel" data-tab="ps1">

<pre><code class="lang-powershell">
[CmdletBinding()]
param (
    $targetFolderName = &quot;Copilot-Studio-Agent&quot;
)
begin {

    $startingPath = Get-Location
    $targetFolder = Join-Path -Path &quot;$(Get-Location)&quot; -ChildPath &quot;$($targetFolderName)&quot;
        
    # ------------------------------------------------------------------------------
    # Introduction
    # ------------------------------------------------------------------------------

    Write-Host &quot;*** This script will generate out all the agents ***&quot; -ForegroundColor Green
    
    # ------------------------------------------------------------------------------

}
process {

    # ------------------------------------------------------------------------------
    # Deploying the agent
    # ------------------------------------------------------------------------------
    # Test if the target folder contains teamsapp.yml file
    $teamsAppFile = &quot;teamsapp.yml&quot;
    $teamsAppFilePath = Join-Path -Path $targetFolder -ChildPath $teamsAppFile
    if (Test-Path -Path $teamsAppFilePath) {
       
        Write-Host &quot;Deploying the target agent $targetFolder&quot; -ForegroundColor Green
        Set-Location -Path $targetFolder
        
        # Yeap, thats it. If you are not logged in, it will prompt you for logging in.
        teamsapp provision

        Write-Host &quot;Agent $targetFolder Deployed.&quot; -ForegroundColor Cyan
    }else{
        Write-Host &quot;File $teamsAppFile does NOT exist in the target folder.&quot; -ForegroundColor Red
    }
    
}
end{
  Set-Location -Path $startingPath
  Write-Host &quot;Done! :)&quot; -ForegroundColor Green
}

</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_ps2" role="tabpanel" data-tab="ps2" aria-hidden="true" hidden="hidden">

<pre><code class="lang-powershell">
Read-Host -Prompt &quot;This script will bulk deploy for all agents in the current directory. Press Enter to continue or Ctrl+C to cancel.&quot;

.\Set-Deploy.ps1 -targetFolderName &quot;Copilot-Studio-Agent&quot;
.\Set-Deploy.ps1 -targetFolderName &quot;Other Agent 1&quot; 
.\Set-Deploy.ps1 -targetFolderName &quot;Other Agent 2&quot;
.\Set-Deploy.ps1 -targetFolderName &quot;Other Agent 3&quot;

</code></pre>
</section>
</div>
<div class="highlight-tool">
<p>Check out the <strong>Microsoft Teams Toolkit CLI</strong> to learn more at: <a href="https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/teams-toolkit-cli?pivots=version-three">https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/teams-toolkit-cli?pivots=version-three</a></p>
</div>
<h2 id="source-blog-article">Source Blog Article</h2>
<ul>
<li><a href="https://pkbullock.com/blog/2025/create-declarative-agent-with-teams-toolkit-cli">Create Microsoft 365 Copilot declarative agents with Teams Toolkit CLI | pkbullock.com</a></li>
</ul>
<h2 id="contributors">Contributors</h2>
<table>
<thead>
<tr>
<th>Author(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Paul Bullock</td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THESE SAMPLES ARE PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<img src="https://m365-visitor-stats.azurewebsites.net/script-samples/scripts/copilot-bulk-deploy-declarative-agents" aria-hidden="true">
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Script Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <!-- <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer"> -->
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    
    <script type="text/javascript" src="../styles/clipboard.min.js"></script>
    <script type="text/javascript" src="../styles/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="../styles/loadsamples.js"></script>
    <script type="text/javascript" src="../styles/filtersamples.js"></script>

  </body>
</html>